(window.webpackJsonp=window.webpackJsonp||[]).push([[107],{487:function(t,e,v){"use strict";v.r(e);var a=v(29),_=Object(a.a)({},(function(){var t=this,e=t.$createElement,v=t._self._c||e;return v("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[v("h1",{attrs:{id:"why-为什么我们需要-vite"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#why-为什么我们需要-vite"}},[t._v("#")]),t._v(" Why - 为什么我们需要 Vite")]),t._v(" "),v("p",[t._v("在基于 webpack 或者 rollup 为打包工具的大型项目中，如 amaze，热更新的时间成本较高，可能长达 10s+，在关闭 aot 之前，甚至达到 100 多 s")]),t._v(" "),v("p",[t._v("不仅是开发体验极差，打包时长较长也大大降低了开发的效率")]),t._v(" "),v("p",[t._v("但是基于 ESM 开发的打包工具，为解决这一问题提供了新思路")]),t._v(" "),v("h1",{attrs:{id:"what-啥是-vite"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#what-啥是-vite"}},[t._v("#")]),t._v(" What - 啥是 Vite")]),t._v(" "),v("p",[t._v("Vite 是尤大在去年跟 Vue3 一起发布的一款开发工具，特点就跟 Vite 的法语含义一样——“快”")]),t._v(" "),v("p",[t._v("它的本质是是一个开发服务器，类似 webpack-dev-server，它只是一个用于本地开发环境使用的打包工具，部署上线的版本依然使用 rollup 进行打包")]),t._v(" "),v("p",[t._v("Vite 之所以快，主要有以下原因：")]),t._v(" "),v("ul",[v("li",[t._v("基于 ESM\n"),v("ul",[v("li",[t._v("不需要编译过程")]),t._v(" "),v("li",[t._v("具有懒加载特性")])])]),t._v(" "),v("li",[t._v("浏览器代替 webpack 解析依赖")]),t._v(" "),v("li",[t._v("使用 esbuild 代替 webpack")])]),t._v(" "),v("h2",{attrs:{id:"esbuild"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#esbuild"}},[t._v("#")]),t._v(" esbuild")]),t._v(" "),v("p",[t._v("Vite 使用 esbuild 替代了 webpack 进行模块的编译工作")]),t._v(" "),v("p",[t._v("esbuild 之所以比 webpack 快，主要也有下面几个原因：")]),t._v(" "),v("ul",[v("li",[t._v("使用 go 编写，编译为原生代码")]),t._v(" "),v("li",[t._v("编译、输出和 sourcemap 生成都是并行")]),t._v(" "),v("li",[t._v("没有昂贵的数据转换")]),t._v(" "),v("li",[t._v("代码写的好..")])]),t._v(" "),v("h2",{attrs:{id:"请求拦截原理"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#请求拦截原理"}},[t._v("#")]),t._v(" 请求拦截原理")]),t._v(" "),v("p",[t._v("既然使用了 ESM，那么浏览器在遇到相关的模块引入是就会进行 http 请求，那么 vite 是如何对请求做出相应的呢")]),t._v(" "),v("p",[t._v("vite 本身基于 koa 开发，在请求来了之后，会接收到 ctx.path 这个参数，基于不同的类型，vite 会做出不同的处理")]),t._v(" "),v("p",[v("img",{attrs:{src:"https://peterchen97.coding.net/p/img2/d/test/git/raw/master/d7dd9001e503857266b6faf855f6c49de5098fe40b6a74ff878a20db6e521a82.png",alt:"图 2"}})]),t._v(" "),v("h2",{attrs:{id:"存在的问题"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#存在的问题"}},[t._v("#")]),t._v(" 存在的问题")]),t._v(" "),v("ul",[v("li",[t._v("ESM 没法直接用在生产环境上")]),t._v(" "),v("li",[t._v("开发环境使用 ESM，但是生产环境实际上是用的是 commonJS，一些情况下会导致一些不一致的问题")]),t._v(" "),v("li",[t._v("一些代码没有提供 ESM 格式的包，需要做兼容")])])])}),[],!1,null,null,null);e.default=_.exports}}]);