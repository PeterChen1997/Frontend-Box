(window.webpackJsonp=window.webpackJsonp||[]).push([[94],{474:function(s,e,t){"use strict";t.r(e);var a=t(29),r=Object(a.a)({},(function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"tree-shaking"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tree-shaking"}},[s._v("#")]),s._v(" tree-shaking")]),s._v(" "),t("p",[s._v("tree shaking 就是通常用于描述移除 JavaScript 上下文中的未引用代码(dead-code)。它依赖于 ES2015 模块语法的 静态结构 特性，例如 import 和 export")]),s._v(" "),t("ul",[t("li",[s._v("esm: 静态引入")]),s._v(" "),t("li",[s._v("cjs：动态引入")])]),s._v(" "),t("h2",{attrs:{id:"实现方案"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#实现方案"}},[s._v("#")]),s._v(" 实现方案")]),s._v(" "),t("p",[s._v("在webpack实现Trss shaking有两种不同的方案：")]),s._v(" "),t("ul",[t("li",[s._v("usedExports：通过标记某些函数是否被使用，之后通过Terser来进行优化的")]),s._v(" "),t("li",[s._v("sideEffects：跳过整个模块/文件，直接查看该文件是否有副作用")])]),s._v(" "),t("h2",{attrs:{id:"esm"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#esm"}},[s._v("#")]),s._v(" ESM")]),s._v(" "),t("p",[s._v("特性")]),s._v(" "),t("ul",[t("li",[s._v("import 只能作为模块顶层的语句出现")]),s._v(" "),t("li",[s._v("import 的模块名只能是字符串常量")]),s._v(" "),t("li",[s._v("import binding 是 immutable 的")])]),s._v(" "),t("p",[s._v("由于上述特性，ESM 支持静态分析")]),s._v(" "),t("p",[s._v("但是并不是所有的 esm 都支持 tree_shaking，比如")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'utils/refresh'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("这类带副作用的模块，对于这种模块可以这样处理：")]),s._v(" "),t("p",[s._v("在 sideEffects 中通过数组声明，使其在 Tree Shaking 的范围之外\n模块改造，暴露成员支持显式调用")]),s._v(" "),t("h3",{attrs:{id:"sideeffects"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sideeffects"}},[s._v("#")]),s._v(" sideEffects")]),s._v(" "),t("p",[s._v("上面提到的所有代码都不包含副作用，因此我们可以标记该属性 false 以通知 webpack 它可以安全地修剪未使用的导出")]),s._v(" "),t("h2",{attrs:{id:"cjs"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cjs"}},[s._v("#")]),s._v(" CJS")]),s._v(" "),t("p",[s._v("CMJ 中的 require，只有执行以后才知道引用的是什么模块")]),s._v(" "),t("h2",{attrs:{id:"其他"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#其他"}},[s._v("#")]),s._v(" 其他")]),s._v(" "),t("ul",[t("li",[s._v("css tree-shaking\n"),t("ul",[t("li",[s._v("PurgeCss plugin")])])])])])}),[],!1,null,null,null);e.default=r.exports}}]);