# MongoDB

## 优点

架构上：

- 面向文档的存储：以 JSON 格式的文档保存数据
- 任何属性都可以建立索引
- 复制以及高可扩展性
- 自动分片
- 丰富的查询功能
- 快速的即时更新

为什么采用：

- 架构简单
- 没有复杂的连接
- 深度查询能力,MongoDB 支持动态查询
- 容易调试
- 容易扩展
- 不需要转化/映射应用对象到数据库对象
- 使用内部内存作为存储工作区,以便更快的存取数据

## 和 MySQL 的差别

- MySQL 和 MongoDB 两者都是免费开源的数据库
- MySQL 和 MongoDB 有许多基本差别包括数据的表示(data representation)，查询，关系，事务，schema 的设计和定义，标准化(normalization)，速度和性能

## 适用场景

- 大数据
- 内容管理系统
- 移动端 Apps
- 数据管理

## 分片

- 分片是将数据水平切分到不同的物理节点
- 当应用数据越来越大的时候，数据量也会越来越大，当数据量增长时，单台机器有可能无法存储数据或可接受的读取写入吞吐量，利用分片技术可以添加更多的机器来应对数据量增加以及读写操作的要求

## 支持主键外键关系吗

默认 MongoDB 不支持主键和外键关系。 用 Mongodb 本身的 API 需要硬编码才能实现外键关联，不够直观且难度

## 索引

索引用于高效的执行查询, 没有索引的 MongoDB 将扫描整个集合中的所有文档, 这种扫描效率很低,需要处理大量的数据

索引是一种特殊的数据结构, 将一小块数据集合保存为容易遍历的形式. 索引能够存储某种特殊字段或字段集的值, 并按照索引指定的方式将字段值进行排序

## 副本集（避免单点故障）

在 MongoDB 中副本集由一组 MongoDB 实例组成，包括一个主节点多个次节点，MongoDB 客户端的所有数据都 写入主节点(Primary),副节点从主节点同步写入数据，以保持所有复制集内存储相同的数据，提高数据可用性

## MongoDB 为何使用 GridFS 来存储文件？

GridFS 是一种将大型文件存储在 MongoDB 中的文件规范。使用 GridFS 可以将大文件分隔成多个小文档存放，这样我们能够有效的保存大文档，而且解决了 BSON 对象有限制的问题

## 索引类型有哪些？

- 单字段索引(Single Field Indexes)
- 复合索引(Compound Indexes)
- 多键索引(Multikey Indexes)
- 全文索引(text Indexes)
- Hash 索引(Hash Indexes)
- 通配符索引(Wildcard Index)
- 2dsphere 索引(2dsphere Indexes)

## 什么是 master 或 primary？

副本集只能有一个主节点能够确认写入操作来接收所有写操作，并记录其操作日志中的数据集的所有更改(记录在 oplog 中)

在集群中，当主节点（master）失效，Secondary 节点会变为 master
