# TCP / UDP

## TCP

TCP（Transmission Control Protocol，传输控制协议）是基于连接的协议，也就是说，在正式收发数据前，必须和对方建立可靠的连接。

一个TCP连接必须要经过三次“对话”才能建立起来

### 名词解释

1. ACK 是 TCP 报头的控制位之一，对数据进行确认。确认由目的端发出，用它来告诉发送端这个序列号之前的数据段都收到了
   1. 比如确认号为X，则表示前 X-1 个数据段都收到了，只有当 ACK=1 时,确认号才有效，当 ACK=0 时，确认号无效，这时会要求重传数据，保证数据的完整性
2. SYN 同步序列号，TCP建立连接时将这个位 置1
3. FIN 发送端完成发送任务位，当TCP完成数据传输需要断开时,提出断开连接的一方将这位置1

### 特性

#### 三次握手

需要进行三次握手：

1. 主机向服务器发送一个建立连接的请求；发送一个含有同步序列号的标志位的数据段给服务器
2. 服务器接到请求后发送同意连接的信号；用一个带有确认应答（ACK）和同步序列号（SYN）标志位的数据段响应主机
3. 主机接到同意连接的信号后，再次向服务器发送了确认信号 ;

#### 四次挥手

1. 第一次：当主机A完成数据传输后,将控制位 FIN 置1，提出停止 TCP 连接的请求
2. 第二次：主机B收到FIN后对其作出响应，确认这一方向上的TCP连接将关闭,将 ACK 置1
3. 第三次：由B端再提出反方向的关闭请求,将 FIN 置1
4. 第四次：主机A对主机B的请求进行确认，将 ACK 置1，双方向的关闭结束

注意：这里的四次挥手中服务器两次向主机发送消息，第一次是回复主机已收到断开的请求，第二次是向主机确认是否断开，确保数据传输完毕

### TCP应用

- HTTP
- SMTP 电子邮件
- TELENT 远程终端接入
- FTP

## UDP

UDP（User Data Protocol，用户数据报协议）是与TCP相对应的协议。它是面向 **非连接** 的协议，它不与对方建立连接，而是直接就把数据包发送过去

UDP适用于一次只传送少量数据、对可靠性要求不高的应用环境

### UDP应用

- DNS
- TFTP
- RIP 路由选择协议
- DHCP / BOOTP
- SNMP 网络管理
- NFS 远程文件服务器

## 异同点

1. 基于连接与无连接
2. 对系统资源的要求（TCP 较多，UDP 少）
3. UDP程序结构较简单
4. 流模式与数据报模式
5. TCP保证数据正确性，UDP可能丢包
6. TCP保证数据顺序，UDP不保证
